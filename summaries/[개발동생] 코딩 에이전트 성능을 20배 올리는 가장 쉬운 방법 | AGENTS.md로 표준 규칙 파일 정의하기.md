# ![Thumbail](https://i.ytimg.com/vi/LHx_EFoLonQ/sddefault.jpg)
## **AI 에이전트 규칙 파일 관리의 필요성**

- 다양한 코딩 에이전트(커서, 클로드, 제미나이 등) 사용 시, `cursor.rules`, `claude.md`, `gemini.md`와 같이 에이전트별로 다른 형식의 규칙 파일 존재함.

- 하나의 코딩 에이전트만 사용하지 않고 여러 에이전트를 오가며 개발하는 개발자가 많아짐에 따라, 이처럼 다양한 규칙 파일 정의 및 관리 방식에 대한 고민이 많음.

- AI 에이전트를 활용한 개발에서 규칙 파일 하나하나를 잘 정의하는 것도 중요하지만, 이를 효과적으로 관리하는 것이 까다로움.

## **AI 에이전트용 표준 규칙 파일 `agent.md` 소개**

- `agent.md`는 모든 규칙 파일을 하나로 정의하여 관리할 수 있게 해주는 에이전트용 규칙 파일임.

- `agent.md`는 OpenAI 코덱스 팀에서 처음 발표한 AI 에이전트용 표준 규칙 파일임.

- 프로젝트에서 AI 에이전트에게 필요한 맥락과 지침을 주입시켜주는 간단한 마크다운 파일임.

- 오픈AI 코덱스 팀이 주도했지만, 앰프 코드, 구글 줄스, 커서, 팩토리 AI 등 여러 개발 팀이 참여하여 이 표준을 정의하고 관리 중임.

- 현재 `agent.md` 파일은 리눅스 산하 재단 중 하나인 Agentic AI Foundation에서 관리 중임.

- Agentic AI Foundation은 모델 컨텍스트 프로토콜(MCP), 구스, `agent.md` 등 오픈소스 AI 프로젝트를 관리함.

- 엔트로픽은 MCP를 리눅스 재단에 기부한 바 있음.

- 현재 `agent.md`를 사용 가능한 코딩 에이전트:

- OpenAI 코덱스, 커서, 팩토리 AI, 제미나이 CLI, 오픈 코드, 깃허브 코파일럿 VS 코드, 윈드프 등 대부분의 코딩 에이전트가 AI 에이전트용 표준 규칙 정의 파일인 `agent.md`를 지원함.

- 하지만 클로드 코드는 아직 `agent.md`를 지원하지 않음.

- 엔트로픽이 MCP를 리눅스 재단에 기부했음에도, 같은 재단이 관리하는 `agent.md`를 도입하지 않은 점이 의아하게 느껴짐.

- 클로드 코드 사용자들도 `agent.md` 미지원에 대한 불만이 많으며, 깃허브 클로드 코드 이슈에 관련 요청이 많음.

- 조만간 클로드 코드에서도 `agent.md`를 지원할 것으로 예상됨.

## **`agent.md` 활용의 중요성 및 장점**

- 각 코딩 에이전트마다 규칙 파일 포맷이나 파일명이 분산되어 있음.

- `agent.md`를 활용하면 어떤 코딩 에이전트를 사용하든 하나의 규칙 파일로 일관성을 유지할 수 있음.

- 주요 코딩 에이전트들이 `agent.md`를 대부분 지원하므로, 개별 에이전트마다 규칙을 정의하기보다 `agent.md`로 통일하여 활용하는 것이 더 좋음.

## **가장 효율적인 `agent.md` 구조 및 관리 방법**

- `agent.md`는 단순한 마크다운 파일로, 특별한 포맷 규칙이 정해져 있지는 않지만, 정의해두면 좋은 필수 요소들이 있음.

- **중첩된 파일 사용 가능**:

- 루트 경로에 하나의 `agent.md` 파일만 정의하는 것이 아니라, 여러 개의 `agent.md` 파일을 중첩된 경로에 생성할 수 있음.

- 이는 하나의 규칙 파일을 너무 크게 만들지 않고, 특정 도메인이나 기술 영역에 특화된 작은 규칙 파일들로 여러 개를 정의하여 컨텍스트 효율을 높일 수 있음.

- **권장되는 효율적인 `agent.md` 구조**:

- **하나의 `agent.md`는 500줄 이내로 유지**:

- 규칙이 너무 커지면 LLM 모델의 한정된 컨텍스트 윈도우 사이즈로 인해 컨텍스트 낭비가 발생함.

- 컨텍스트 효율이 떨어지므로, 최소한의 가장 중요한 컨텍스트만 넣어 500줄 이내로 구성하는 것을 권장함.

- **큰 프로젝트는 여러 개의 중첩 가능한 작은 규칙으로 나눠 정의**:

- 루트에 `agent.md`를 두고, 다른 서브 `agent.md`를 여러 개 생성하여 연결하는 방식이 매우 효율적임.

- **소스 코드와 함께 버전 관리**:

- `agent.md` 파일도 소스 코드와 함께 버전 관리를 하는 것을 추천함.

- 프로젝트의 폴더 단위 또는 기능별로 서브 `agent.md`들을 생성하고, 관련 코드가 변경될 때 해당 `agent.md` 파일도 함께 수정하여 버전 관리함.

- 코드 리뷰 시 코드뿐만 아니라 `agent.md` 파일도 같이 리뷰하는 것이 좋음.

- `agent.md` 파일은 AI 에이전트의 코드 생성 및 작업 단계에 큰 영향을 미치므로, 모든 팀원은 이 파일의 내용을 인지하고 규칙의 타당성 및 올바름을 확인하는 과정을 거쳐야 함.

- **신규 팀원 온보딩에 활용**:

- `agent.md` 파일에는 프로젝트 실행 및 테스트 방법, 코딩 스타일, 해야 할 일/하지 말아야 할 일, 코드베이스 구조 등 다양한 정보가 들어 있음.

- AI 에이전트뿐만 아니라 인간 개발자에게도 유용한 가이드 역할을 함.

- 팀원이 코드베이스를 빠르게 파악하고 작업을 시작할 수 있는 좋은 출발점이 됨.

- **반복적인 개선 중요**:

- 한 번 작성했다고 끝이 아니라, 프로젝트 구조 변경이나 기술 스택 추가 시 AI 에이전트가 규칙을 잘 준수하는지, 실수하거나 놓치는 부분이 있는지 꾸준히 모니터링하고 업데이트해야 함.

## **`agent.md` 자동 생성을 위한 마스터 프롬프트 활용**

- 마스터 프롬프트를 사용하여 `agent.md` 파일을 효율적으로 생성할 수 있음.

- 이 마스터 프롬프트를 실행하면, 프로젝트 전체 구조를 검토하여 메인 `agent.md` 파일과 도메인 및 프로젝트별 서브 `agent.md` 파일들을 구조에 맞게 자동으로 생성해 줌.

- **마스터 프롬프트의 핵심 철학**:

- 모든 `agent.md` 파일은 가독성과 토큰 효율성을 위해 500라인 미만으로 유지하도록 함.

- 불필요한 컨텍스트 낭비를 방지하기 위해 이모지 같은 AI가 자주 생성하는 요소를 명시적으로 제외함.

- **루트 `agent.md` (관제탑 역할)**:

- 최상위 경로에 생성하며, 하위 `agent.md`에게 작업을 위임할 수 있는 파일로 설계함.

- 상세 구현은 하위 파일로 위임함.

- **골든 룰 (Golden Rules)**:

- AI 에이전트에게 명령 시 매우 효과적인 방법론으로, 해야 할 일과 하지 말아야 할 일을 명확하게 나누어 적으면 에이전트가 명령을 더 효율적으로 따름.

- **루트 `agent.md` 구성 단계 (Step 1)**:

- 비즈니스 목표와 테크 스택 요약.

- 골든 룰즈 정의: Immutable(보안 아키텍처 제약 등), 해야 할 일(Do's), 하지 말아야 할 일(Don'ts)을 포함하여 명확한 행동을 적음.

- 기본적인 코딩 컨벤션, 깃허브 전략, 커밋 메시지 포맷 등 표준 및 참고 사항.

- **컨텍스트 맵**: 루트 `agent.md`는 관제탑 역할을 하므로 모든 컨텍스트를 담지 않음. 세부 사항에 대해서는 중첩된 하위 `agent.md`로 연결되며, 그 연결점을 컨텍스트 맵에 링크로 알려 줌.

- **중첩된 구조로 규칙 정의 단계 (Step 2)**:

- 고유한 컨텍스트가 발생하는 지점을 식별하여 `agent.md` 파일을 생성함.

- 예: 의존성 경계(Dependency Boundary), 프레임워크 경계(Framework Boundary), 논리적 경계(Logical Boundary) 또는 비즈니스 로직 밀도가 높은 핵심 모듈이 있는 경우, 해당 영역에 대해 중첩된 `agent.md`를 생성하여 더 세부적인 규칙을 정의함.

## **`agent.md` 적용 및 그 효과**

- 제공되는 마스터 프롬프트를 커서나 제미나이 등 에이전트에 붙여넣고 실행하면 됨.

- 에이전트가 마스터 프롬프트를 참고하여 프로젝트 전체 구조를 검토하고, 적절한 경로에 최상위 및 서브 `agent.md` 파일들을 자동으로 생성해 줌.

- 프로젝트에 규칙 파일의 유무에 따라 에이전트의 성능이 크게 차이 남.

- 대규모 프로젝트나 모노레포(Mono-repo)와 같이 여러 레포지토리를 한 번에 조합하는 프로젝트일수록 규칙 파일 정의가 더욱 중요함.

- 자동 생성된 최상위 `agent.md` 파일은 비즈니스 목표, 테크 스택, 의존성 설치 명령어, 골든 룰즈(Immutable, Do's, Don'ts) 등을 포함함.

- 컨텍스트 맵을 통해 세부 도메인별 구현 사항은 하위 `agent.md` 파일로 링크 연결되며, 이 파일들도 자동으로 생성됨.

- `agent.md`는 하나의 최상위 경로 파일에서만 동작하는 것이 아니라, 중첩된 경로에서도 각각의 에이전트 규칙이 동작함.

- 예를 들어, API 경로에 대해 작업할 때는 해당 `API/agent.md` 파일이 컨텍스트로 들어와 작업이 됨.

- UI 컴포넌트 작업을 할 때는 `component/UI/agent.md` 파일에 있는 규칙을 가져와 작업함.

- 하나의 파일에 규칙을 계속 늘려 컨텍스트를 잡아먹는 방식보다 훨씬 더 컨텍스트 효율화가 높아짐.

- 이를 통해 AI 에이전트의 성능을 더욱 높일 수 있음.

## **결론 및 권장사항**

- 아직 일부 에이전트에서는 `agent.md` 표준을 지원하지 않지만, MCP처럼 거의 모든 코딩 에이전트에서 표준으로 지원하게 될 것으로 예상함.

- 현재 진행 중인 여러 프로젝트에서도 산재된 에이전트 규칙 파일들을 `agent.md`라는 하나의 표준화된 규칙으로 통일하려 노력 중임.

- 이러한 `agent.md` 규칙 파일 구조를 적극적으로 활용할 것을 추천함.

#AI에이전트 #규칙파일 #agentmd #표준화 #코딩에이전트 #컨텍스트관리 #생산성향상 #개발효율화 #버전관리 #팀온보딩 #마스터프롬프트 #오픈소스